function #\hyperref[sailRISCVzhandlezytrapzyextension]{handle\_trap\_extension}#(p : Privilege, pc : xlenbits, u : #\hyperref[sailRISCVzoption]{option}#(unit)) -> unit = {
  match p {
    Machine => {
      let (representable, mepcc) = #\hyperref[sailRISCVzsetCapAddr]{setCapAddr}#(PCC, pc);
      assert(representable, "mepcc should always be representable");
      MEPCC   = mepcc
    },
    Supervisor => {
      let (representable, sepcc) = #\hyperref[sailRISCVzsetCapAddr]{setCapAddr}#(PCC, pc);
      assert(representable, "sepcc should always be representable");
      SEPCC   = sepcc
    },
    User => {
      let (representable, uepcc) = #\hyperref[sailRISCVzsetCapAddr]{setCapAddr}#(PCC, pc);
      assert(representable, "uepcc should always be representable");
      UEPCC   = uepcc
    }
  }
}
